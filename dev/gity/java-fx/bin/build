#!/usr/bin/env bash

set -euo pipefail
DIR="$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd)"
cd "$DIR/.."

rm -f *.class minimaljavafxapp
javac --module-path "$FX_HOME" \
      --add-modules javafx.controls \
      MinimalJavaFXApp.java
java -agentlib:native-image-agent=config-output-dir=./META-INF/native-image \
     --module-path "$FX_HOME" \
     --add-modules javafx.controls \
     --enable-native-access=javafx.graphics \
     MinimalJavaFXApp.java
native-image --module-path "$FX_HOME" \
             --add-modules javafx.controls \
             --enable-native-access=javafx.graphics \
             -H:NativeLinkerOption=-L"${FX_HOME}" \
             -H:NativeLinkerOption=-lglass \
             -H:NativeLinkerOption=-lprism_es2 \
             -H:NativeLinkerOption=-lprism_common \
             -H:NativeLinkerOption=-ljavafx_font \
             -H:NativeLinkerOption=-ljavafx_iio \
             -cp . MinimalJavaFXApp
